출입모니터링 통합버전

버전 1.2.3, 최종수정일 : 190725
1) 홈넷 설정
 - parkset.ini파일에 '홈넷' 부분
현대통신:1  / 코콤:2 / 아이컨트롤스:3 / 계영정보통신:4, 삼성중공업 유비즈 :5(구현안함) /
이즈빌 : 6 / 한화(비쥬드림) : 7 / 홈넷없음 : 0

2) 입출차 LPR개수 선택
 - parkset.ini파일에 '입차LPR수' : (입차 1~4) , '출차LPR수' : (출차0~4)
* 추후 unitinfo에서 읽어와서 자동 적용되게 수정할 예정

3) 로그에 전광판에 뿌린 문구 추가

4) 정기차량, 일반차량 문구 변경
 - ini파일에 '정기차량문구', '일반차량문구' 필드추가

5) 아파트 , 일반 현장에 맞게 동/호 문구 변경
 - ini파일에 '아파트' 부분
    0 : 아파트아님, 1 : 아파트

6) 이미지 로드부분 로직 맨뒤로 이동하여 차단기 늦게 열리는 현상 방지

7) 차단기 컨트롤 여부(모니터링 전용 프로그램시 설정)
 - parkset.ini파일에 '차단기 제어' 부분
 0 : 제어안함 , 1 : 제어

8) 각 LPR별로 차단기 제어 버튼(버튼 좌클릭시 열기/닫기/열기고정/고정해제 팝업)

9) 블랙리스트 기능 추가 (입차때만 체크)

10) 개방운영 모드
- ini 파일에 '개방운영' 1: 유인모드, 0: 개방모드

11) LPR연결 끊김시 재연결 처리

12) 프로그램 시작시 로그인 여부
- ini 파일에 '로그인'   1:로그인사용,  0:로그인미사용 (로그인미사용시 근무자번호 : 90 근무자명 : 미로그인) 

13) 방문증 발행여부
- 일반차량 입차시 방문증 발행여부 1사용 0미사용 , msg01~10까지 방문사유 빠른입력 버튼 사용가능
iondata에 Reserve1 사유 , Reserve2 동 , Reserve3 호

14) 부분미인식 차량 숫자 6자리 비교 추가
- 12X1234로 부분미인식시 숫자만 비교하여 12가1234정기차량과 매칭되도록 수정(6proc사용시)
!!!!!!!!MSSQL에서 UFN_GET_NUMBER 함수 추가필수!!!!!!!!!!!!!!

15) 세대통보 테스트시 풀번호 입력(4자리 전송시 자체적으로 변형하여 4자리로 전송)

1.1.7
16) cvnet 홈넷추가(고사장님)

1.1.9
17) 대우건설 푸르지오에 들어가는 2단 4열 전광판 모드로 변경
 - ini파일에 '전광판'에 0은 2단4열 1은 2단6열 
 - IN_DSP, DSP_1, IN_DSP_COLOR_1 값 변경해줘야함 출입모니터링 전광판 설정에서 변경해도 됨

1.2.0
18) 홈넷 코맥스 측과 연동

1.2.1
19) ini정리 전부 [parking]만 쓰는 상황에서 전광판관련 세팅값[DISPLAY]로 변경

1.2.2
20) 현대통신 방문자 추가 ini에서 홈넷방문자=1(1 사용(대림건설), 0 미사용)로 해놓고 
현대통신 1에 둬야함

1.2.3
21) 정기차량 문구 표출 설정 ini에서 (정기문구사용 0 문구사용, 1 그룹명, 2 회사명, 3부서명, 4 이름)

1.2.4
22) 이지빌 방문자 기능 

1.2.5
23) 아이콘트롤스 방문자 개발

1.2.6
24) 홈넷홈 세대통보 기능 추가

1.2.7
25) (DB상태체크&재연결) 1분마다 타이머 추가

1.2.8
26) is_ping 함수에 ip가 없이 ping체크 할경우 TRUE가 반환되지 않도록 변경
27) 유인운영모드 중 일반차량 출차 시 차단기가 자동으로 올라가지 않도록 변경 => 제거

1.2.9 (181224)
28) 모니터링 모드에서는 전광판 설정 메뉴 비활성화
29) 후방데이터는 nBackData라는 변수로 LPR Read 이벤트에서 값을 준 후 normalproc, RecvLprproc에 파라메타로
전달하여 차단기 오픈여부 확인(후방데이터 안열리도록 수정)
30) 출차 LPR재연결 로직 추가 - 181227
31) 블랙리스트 알람내용 확장, 알림횟수, 화면자동닫힘 ini옵션화
32) 영업차량 통과기능 추가
33) 인천한국전력 기능추가(할인시간>주차시간 일때에만 출차가능)
++) 입출차 이미지 리스트 더블클릭 수정메뉴 표출시, 이미지 초기화 작업먼저.

1.3.0
31) 블랙리스트 알람내용 확장, 알림횟수, 화면자동닫힘 ini옵션화
32) 영업차량 통과기능 추가
33) 인천한국전력 기능추가(할인시간>주차시간 일때에만 출차가능)
34) 블랙리스트 알람 소리장치 문제 옵션처리
35) 부제기능 추가
36) 기본 마스터ID 이름변경 옵션추가(외주 대비)
37) 정기차량 그룹별 차단기 개방여부 설정기능 추가
38) 일반차량 자동출차 옵션처리(미인식차량은 자동출차)
39) 코맥스 홈넷 전송오류 문제 해결 패치(코맥스 서버 문제)
40) 방문증발급기 TCP / DB 자동으로 붙도록 추가
41) 입출차 LPR 각5개까지 추가

--------- 버그수정--------------
*1_1_1 버전에 출차LPR 동/호수가 입차LPR 화면에 뜨는 버그 수정
*정기차량, 일반차량 문구 반대로 나오는것 수정
*방문자 기능 DB저장안하는거 작업 Reserve1 사유 , Reserve2 동 , Reserve3 호
 DB그리드 (sgIn)쪽도 수정해야함
*1_1_6 버전에 코콤 다시 붙는로직에서 컴포넌트명 잘못되어있음 btnbind
*1_1_7 버전 UFN_GET_NUMBER 함수로 차번 숫자만 비교부분에서 비교값이 숫자로 인식되어 차량번호를 잘못입력한 정기차량이 있으면 오버플로우 발생 ==> 1_1_8버전에서 따옴표 추가하여 문자열로 바꿔줌
*1_1_8 버전 CVNet 세대통보 처리 중 함수 누락된 부분 있어서 추가
*1_1_9 이하 버전에 개방운영모드인데도 ABP위반, 일자위반 등 차량 입/출 불가하였던것 수정
*1_2_2 이하 버전에서 블랙리스트 사용시 wait걸리는 문제 해결, 차량 이미지 안뜨는것 수정
Parkset ini에 버전 기록 추가  
*1_2_4 버전에서 이지빌 방문자 기록 자동삭제 타이머에 버그 해결 
*1_2_4 이하 버전에서 현대통신 테스트시 차량번호 3자리만 가는 문제 해결
*1_2_4 이하 버전에서 기기설정에 LPR이 너무많으면 fromshow에서 예외처리되는부분 myno체크 추가
*1_2_6 이하 버전에서 프로그램 종료 이벤트가 실행되지않아 종료확인 창 안뜨는것 해결
*현대통신에서 뭔가 작업 한듯 2018년 중순때부터 갑자기 소켓이 먹통이 되는 일이 가끔 발생함 소켓 리셋 작업 추가
*1_2_6 이하 버전에서 홈넷홈 비정상 연결상태 버그 보안
*1_2_6 이하 버전에서 블랙리스트 처리 중 예외 로직 추가 
*1_2_6 이하에서 normalproc에서 DB접속 예외떨어지면 bNCInProcWait값이 true남아서 일반차량 처리안되는현상대응
*1_2_6 이하 버전에서 tInAlive, tOutAlive 타이머 동작 주기 10분->1분으로 수정
*1_2_8 이하 버전에서 아이콘트롤스 세대통보 연동시 데이터 파싱부분 순서안맞는것 수정
*1_2_8 이하 버전에서 개방모드일시 후방데이터도 차단기 개방, 해당내용 수정
*1_2_9 이하 버전에서 cvnet 홈넷 체크조건 잘못되어있어서 기간만 맞으면 모든차량이 방문차량 처리되던 것 수정
